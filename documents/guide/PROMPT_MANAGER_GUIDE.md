# 프롬프트 관리 웹페이지 사용 가이드

## 개요
프롬프트 관리 시스템은 POST `/api/memo/refine` API를 위한 동적 프롬프트를 관리하고 테스트할 수 있는 웹 인터페이스입니다.

## 접속 방법
1. FastAPI 서버 실행:
   ```bash
   python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
   ```

2. 웹 브라우저에서 접속:
   ```
   http://localhost:8000/static/prompt_manager.html
   ```

## 주요 기능

### 1. 프롬프트 관리
- **프롬프트 저장**: 이름과 내용을 입력하여 로컬 스토리지에 저장
- **프롬프트 불러오기**: 저장된 프롬프트 목록에서 선택하여 자동 로드
- **프롬프트 수정**: 기존 프롬프트를 수정하고 재저장
- **프롬프트 삭제**: 불필요한 프롬프트 삭제

### 2. 기본 템플릿
**기본 메모 분석 프롬프트**:
```
당신은 보험회사의 고객 메모를 분석하는 전문가입니다.
고객 메모에서 다음 정보를 정확하게 추출해주세요:

메모: {memo}

다음 JSON 형식으로 응답해주세요:
{
  "summary": "메모 요약",
  "status": "고객 상태/감정",
  "keywords": ["키워드1", "키워드2"],
  "time_expressions": [
    {"expression": "2주 후", "parsed_date": "2024-01-15"}
  ],
  "required_actions": ["필요한 후속 조치"],
  "insurance_info": {
    "products": ["현재 가입 상품"],
    "premium_amount": "보험료 정보",
    "interest_products": ["관심 상품"],
    "policy_changes": ["보험 변경사항"]
  }
}
```

### 3. 프롬프트 테스트
- **메모 입력**: 테스트할 메모 내용 입력
- **실행**: 현재 선택된 프롬프트로 `/api/memo/refine` API 호출
- **결과 확인**: JSON 형태의 분석 결과 실시간 확인

## 사용 예시

### 예시 1: 기본 메모 분석
1. "기본 템플릿" 버튼 클릭으로 기본 프롬프트 로드
2. 테스트 메모 입력:
   ```
   고객이 전화로 보험료 인상에 대해 문의함. 2주 후 다시 연락하기로 함. 현재 자동차보험에 가입되어 있고 화재보험도 관심있어함.
   ```
3. "실행" 버튼 클릭
4. 결과 확인

### 예시 2: 사용자 정의 프롬프트
1. 프롬프트 이름: "간단 요약 프롬프트"
2. 프롬프트 내용:
   ```
   다음 고객 메모를 한 문장으로 요약해주세요: {memo}
   
   JSON 형식으로 응답해주세요:
   {
     "summary": "요약 내용",
     "status": "고객 상태"
   }
   ```
3. "프롬프트 저장" 클릭
4. 메모 입력 후 "실행"으로 테스트

## API 연동 방식

웹페이지는 다음과 같은 형태로 API를 호출합니다:

```javascript
const response = await fetch('/api/memo/refine', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
    },
    body: JSON.stringify({
        memo: "메모 내용",
        custom_prompt: "사용자 정의 프롬프트 (선택사항)"
    })
});
```

## 프롬프트 작성 규칙

### 1. 메모 변수 사용
- 반드시 `{memo}` 변수를 프롬프트에 포함해야 합니다
- 예: `"메모: {memo}"`

### 2. 구조화된 출력
- JSON 형식으로 응답하도록 요청하는 것을 권장합니다
- 필요한 필드들을 명시적으로 지정하세요

### 3. 명확한 지시사항
- 구체적이고 명확한 분석 지시사항을 제공하세요
- 예상되는 출력 형태를 예시로 보여주세요

## 주의사항

1. **프롬프트 저장**: 브라우저의 로컬 스토리지에 저장되므로 브라우저 데이터 삭제 시 사라집니다
2. **API 응답 시간**: LLM 처리로 인해 15-30초 정도 소요될 수 있습니다
3. **오류 처리**: 네트워크 오류나 API 오류 시 적절한 오류 메시지가 표시됩니다

## 문제 해결

### 프롬프트가 저장되지 않는 경우
- 브라우저의 로컬 스토리지가 활성화되어 있는지 확인
- 프롬프트 이름과 내용이 모두 입력되었는지 확인
- 브라우저 개발자 도구(F12)의 Console 탭에서 오류 메시지 확인

### 목록이 업데이트되지 않는 경우
- "목록 새로고침" 버튼을 클릭해보세요
- 브라우저를 새로고침해보세요
- 개발자 도구에서 Console 로그를 확인해보세요

### API 호출이 실패하는 경우
- 서버가 정상적으로 실행 중인지 확인
- 네트워크 연결 상태 확인
- 브라우저 개발자 도구에서 오류 메시지 확인

### 응답이 느린 경우
- OpenAI API 처리 시간으로 인한 정상적인 현상 (15-30초)
- 복잡한 프롬프트일수록 처리 시간이 길어질 수 있음

## 기술적 세부사항

- **프론트엔드**: Vanilla JavaScript, HTML5, CSS3
- **백엔드**: FastAPI, Python
- **저장소**: 브라우저 로컬 스토리지 (클라이언트 사이드)
- **API**: RESTful API with JSON
- **AI 모델**: OpenAI GPT-4 (LangChain 통합)

이 시스템을 통해 다양한 프롬프트를 쉽게 관리하고 테스트하여 최적의 메모 분석 결과를 얻을 수 있습니다.